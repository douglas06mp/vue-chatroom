(function(t){function e(e){for(var a,i,c=e[0],o=e[1],u=e[2],f=0,h=[];f<c.length;f++)i=c[f],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&h.push(s[i][0]),s[i]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a]);l&&l(e);while(h.length)h.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,c=1;c<n.length;c++){var o=n[c];0!==s[o]&&(a=!1)}a&&(r.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},s={app:0},r=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=o;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},1:function(t,e){},"1a37":function(t,e,n){"use strict";var a=n("61ff"),s=n.n(a);s.a},2:function(t,e){},"41aa":function(t,e,n){},"4ee8":function(t,e,n){"use strict";var a=n("41aa"),s=n.n(a);s.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h-100 d-flex justify-content-center align-items-center",attrs:{id:"app"}},[t.isAppLoading?n("div",{staticClass:"spinner-border text-primary",attrs:{role:"status"}},[n("span",{staticClass:"sr-only"},[t._v("Loading...")])]):t._e(),n("transition",{attrs:{name:"slide",mode:"out-in"}},[t.isAppLoading?t._e():n("router-view")],1)],1)},r=[],i={computed:{isAppLoading:function(){return this.$store.getters.isAppLoading}},sockets:{connect:function(){console.log("App.vue connect")}},created:function(){this.$store.dispatch("setData")}},c=i,o=(n("5c0b"),n("2877")),u=Object(o["a"])(c,s,r,!1,null,null,null),l=u.exports,f=n("5132"),h=n.n(f),d=(n("8055"),n("8c4f")),m=(n("caad"),n("b0c0"),n("b64b"),n("2532"),n("96cf"),n("1da1")),p=n("ade3"),v=n("5530"),g=n("2f62"),b=n("bc3a"),C=n.n(b),_=C.a.create({baseURL:"https://chat-room-f3ebb.firebaseio.com/"});a["a"].use(g["a"]);var x=new g["a"].Store({state:{isAppLoading:!0,user:null,currentChat:{},chats:{}},mutations:{setData:function(t,e){var n=e.chats,a=e.currentChat;t.chats=n,t.currentChat=a,t.isAppLoading=!1},login:function(t,e){t.user=e},logout:function(t){t.user=null},selectChat:function(t,e){t.currentChat=t.chats[e]},addChat:function(t,e){t.chats[e]={name:e,chats:{}},t.currentChat=t.chats[e]},deleteChat:function(t,e){delete t.chats[e],t.currentChat=t.chats[Object.keys(t.chats)[0]]},sendMessage:function(t,e){var n=e.idx,a=e.user,s=e.message;t.currentChat.chats=Object(v["a"])({},t.currentChat.chats,Object(p["a"])({},n,{name:a,text:s}))}},actions:{setData:function(t){var e=t.commit;return Object(m["a"])(regeneratorRuntime.mark((function t(){var n,a,s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_.get("data.json");case 2:n=t.sent,a=n.data,s=a,r=a[Object.keys(a)[0]],e("setData",{chats:s,currentChat:r});case 7:case"end":return t.stop()}}),t)})))()},login:function(t,e){var n=t.commit;n("login",e)},logout:function(t){var e=t.commit;e("logout")},selectChat:function(t,e){var n=t.commit;n("selectChat",e)},addChat:function(t,e){var n=t.commit,a=t.state;Object.keys(a.chats).includes(e)?n("selectChat",e):n("addChat",e)},deleteChat:function(t,e){var n=t.commit,a=t.state;Object.keys(a.chats[e].chats).length&&_.delete("data/".concat(e,".json")),n("deleteChat",e)},sendMessage:function(t,e){t.commit;var n=e.idx,a=e.user,s=e.message;this._vm.$socket.emit("sendMessage",{idx:n,user:a,message:s})},SOCKET_sendMessage:function(t,e){var n=t.commit,a=t.state,s=e.idx,r=e.user,i=e.message,c={},o="";Object.keys(a.currentChat.chats).length?(c=Object(v["a"])({},a.currentChat.chats,Object(p["a"])({},s,{name:r,text:i})),o="data/".concat(a.currentChat.name,"/chats.json")):(c={name:a.currentChat.name,chats:Object(v["a"])({},a.currentChat.chats,Object(p["a"])({},s,{name:r,text:i}))},o="data/".concat(a.currentChat.name,".json")),_.put(o,c),n("sendMessage",{idx:s,user:r,message:i})}},getters:{isAppLoading:function(t){return t.isAppLoading},user:function(t){return t.user},currentChat:function(t){return t.currentChat},chats:function(t){return t.chats}}}),y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{staticClass:"w-100 h-100 d-flex justify-content-center align-items-center",attrs:{id:"login"},on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[n("div",{staticClass:"wrapper rounded p-3"},[t._m(0),n("div",{staticClass:"input-group"},[n("span",{staticClass:"message text-warning"},[t._v(t._s(t.validation.firstError("name")))]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-control",attrs:{type:"text",placeholder:"name"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})])])])},w=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"w-100 mb-4"},[n("h4",{staticClass:"text-white d-inline-block"},[t._v("Enter your name")]),n("button",{staticClass:"btn btn-primary rounded-circle float-right",attrs:{type:"submit"}},[n("i",{staticClass:"fas fa-arrow-right"})])])}],j=(n("498a"),n("95b1")),O=n.n(j),$=n("2ef0"),k=n.n($),E=O.a.Validator;a["a"].use(O.a);var P={data:function(){return{name:""}},methods:{login:function(){var t=this;this.$validate().then((function(e){if(e){var n=k.a.capitalize(t.name.trim());t.$store.dispatch("login",n).then(t.$router.push("/chat"))}}))}},validators:{name:function(t){return E.value(t).required()}}},L=P,M=(n("5bad"),Object(o["a"])(L,y,w,!1,null,"7febb4a8",null)),N=M.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h-100 w-100 d-flex justify-content-center align-items-center",attrs:{id:"chatroom"}},[n("div",{staticClass:"container h-75 d-flex justify-content-between"},[n("div",{staticClass:"info h-100 d-flex flex-column justify-content-between"},[n("div",{staticClass:"block d-flex align-items-center"},[n("User",{attrs:{user:t.user}})],1),n("div",{staticClass:"block"},[n("RoomList",{attrs:{chats:t.chats}})],1)]),n("div",{staticClass:"block room"},[n("Chat",{attrs:{currentChat:t.currentChat,user:t.user}})],1)])])},T=[],A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"media w-100 align-items-center px-3"},[t._m(0),n("div",{staticClass:"media-body d-flex justify-content-between align-items-center"},[n("h3",{staticClass:"font-weight-bold"},[t._v(t._s(t.user))]),n("button",{staticClass:"btn btn-primary rounded-circle",on:{click:t.logout}},[n("i",{staticClass:"fas fa-sign-out-alt"})])])])},D=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"avatar rounded-circle mr-3"},[n("img",{attrs:{src:"https://picsum.photos/100/100?random=1",alt:"avatar"}})])}],R={props:{user:String},methods:{logout:function(){this.$store.dispatch("logout").then(this.$router.push("/"))}}},U=R,B=(n("4ee8"),Object(o["a"])(U,A,D,!1,null,"15416b2c",null)),K=B.exports,z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"room-list h-100 p-3 d-flex flex-column justify-content-between"},[n("h3",{staticClass:"font-weight-bold"},[t._v("Chat Room")]),n("ul",{staticClass:"list-group"},t._l(t.chats,(function(e,a,s){return n("li",{key:s,staticClass:"list-group-item my-2 d-flex justify-content-between align-items-center",on:{click:function(e){return t.selectChat(a)}}},[n("h5",{staticClass:"d-inline-block"},[t._v(t._s(a))]),n("button",{staticClass:"btn btn-danger rounded-circle",on:{click:function(e){return e.stopPropagation(),t.deleteChat(a)}}},[n("i",{staticClass:"fas fa-trash"})])])})),0),n("form",{staticClass:"form d-flex justify-content-between align-items-center",on:{submit:function(e){return e.preventDefault(),t.addChat(e)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.newChatName,expression:"newChatName"}],staticClass:"form-control d-inline-block",attrs:{type:"text"},domProps:{value:t.newChatName},on:{input:function(e){e.target.composing||(t.newChatName=e.target.value)}}}),t._m(0)])])},J=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{staticClass:"btn btn-warning rounded-circle",attrs:{type:"submit"}},[n("i",{staticClass:"fas fa-plus"})])}],q={props:{chats:Object},data:function(){return{newChatName:""}},methods:{selectChat:function(t){this.$store.dispatch("selectChat",t)},addChat:function(){if(this.newChatName.trim()){var t=k.a.capitalize(this.newChatName.trim());this.$store.dispatch("addChat",t),this.newChatName=""}else this.newChatName=""},deleteChat:function(t){this.$store.dispatch("deleteChat",t).then(this.$forceUpdate())}}},H=q,V=(n("1a37"),Object(o["a"])(H,z,J,!1,null,"39879040",null)),F=V.exports,G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat py-3 px-4"},[n("h3",{staticClass:"font-weight-bold"},[t._v(t._s(t.currentChat.name))]),n("div",{ref:"content",staticClass:"content p-3 rounded"},t._l(t.currentChat.chats,(function(e,a){return n("div",{key:a,staticClass:"user d-flex align-items-start mb-4",class:{local:e.name===t.user,remote:e.name!==t.user}},[n("div",{staticClass:"avatar text-center mb-2"},[t._m(0,!0),n("h5",{staticClass:"mt-2"},[t._v(t._s(e.name))])]),n("div",{staticClass:"text rounded px-3 py-2"},[t._v(t._s(e.text))])])})),0),n("form",{staticClass:"form mt-4 d-flex justify-content-between align-items-center",on:{submit:function(e){return e.preventDefault(),t.sendMessage(e)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],staticClass:"form-control d-inline-block",attrs:{type:"text"},domProps:{value:t.message},on:{input:function(e){e.target.composing||(t.message=e.target.value)}}}),t._m(1)])])},I=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pic rounded-circle"},[n("img",{attrs:{src:"https://picsum.photos/100/100?random=2",alt:"avatar"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[n("i",{staticClass:"fas fa-reply"})])}],Q={props:{currentChat:Object,user:String},data:function(){return{message:""}},methods:{sendMessage:function(){var t=this;if(this.message.trim()){var e=(new Date).getTime(),n=this.user,a=this.message.trim();this.$store.dispatch("sendMessage",{idx:e,user:n,message:a}).then((function(){return t.scrollToBottom()})),this.message=""}else this.message=""},scrollToBottom:function(t){var e=this.$refs.content;e.scrollTo({top:e.scrollHeight,behavior:"smooth"})}},mounted:function(){this.scrollToBottom()}},W=Q,X=(n("94df"),Object(o["a"])(W,G,I,!1,null,"91062024",null)),Y=X.exports,Z={computed:{user:function(){return this.$store.getters.user},currentChat:function(){return this.$store.getters.currentChat},chats:function(){return this.$store.getters.chats}},components:{User:K,RoomList:F,Chat:Y}},tt=Z,et=(n("db17"),Object(o["a"])(tt,S,T,!1,null,"470c32d5",null)),nt=et.exports;a["a"].use(d["a"]);var at=[{path:"/",name:"login",component:N},{path:"/chat",name:"chat",component:nt,beforeEnter:function(t,e,n){x.getters.user?n():n("/")}}],st=new d["a"]({mode:"history",base:"/",routes:at}),rt=st;n("4989"),n("ab8b");a["a"].config.productionTip=!1,a["a"].use(new h.a({debug:!0,connection:"http://localhost:5000/",vuex:{store:x,actionPrefix:"SOCKET_",mutationPrefix:"SOCKET_"}})),new a["a"]({router:rt,store:x,render:function(t){return t(l)}}).$mount("#app")},"5bad":function(t,e,n){"use strict";var a=n("f57e"),s=n.n(a);s.a},"5c0b":function(t,e,n){"use strict";var a=n("9c0c"),s=n.n(a);s.a},"61ff":function(t,e,n){},9441:function(t,e,n){},"94df":function(t,e,n){"use strict";var a=n("bead"),s=n.n(a);s.a},"9c0c":function(t,e,n){},bead:function(t,e,n){},db17:function(t,e,n){"use strict";var a=n("9441"),s=n.n(a);s.a},f57e:function(t,e,n){}});
//# sourceMappingURL=app.1c81028b.js.map